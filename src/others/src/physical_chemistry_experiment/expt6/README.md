# 数据处理概述

## 高分子链还原

结合周期性边界原理，考虑到最终的高分子链只需要高分子的绝对位置，因而实际上每个粒子在还原过程中只依赖与之键合的粒子和对应的平移量，一个简单的思路是从初始粒子开始，对之后的粒子进行步进检查，即将下一个粒子与当前粒子距离进行判定，超出 $r_c$ 即视作粒子进行了一次跨界，根据两粒子的方向矢对此后所有粒子坐标进行平移，进一步，由于实际上高分子链存在反复的跨界情况，而具体到每个粒子，其最终平移量是当前高分子链相对于原点（参考点）的平移状态乘以周期性边界距离（为定值），即引入一个平移数组来维护此平移状态即可，使用 $[x, y, z]$ 表示，规定 +1 为向正轴方向，反之为负，此时，只需要在判定位移是同时维护平移状态就可以在计算每个粒子时同时得到此时该粒子之后的高分子链的绝对位移状态（相对于参考系原点），进一步，由于高分子链可以视作更多高分子链的结合，而位移状态数组具有可加和性（因为如果参考系固定，最终绝对位移量也是固定的），即一个高分子链的还原可以被拆分成多个高分子链的还原和拼接，而不影响最终的高分子链的相对位置关系，这样处理的好处是各自段之间的运算互不干扰，具有高度的并行性，同时对于具有复杂分支结构的高分子链，在分支处断开可以将复杂的判断逻辑拆分为多个线性高分子链平移量的加和。最终的代码如下：

